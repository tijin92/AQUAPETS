<%- include('../layouts/header.ejs')  %> 

<!--PreLoader-->
<div class="loader">
    <div class="loader-inner">
        <div class="circle"></div>
    </div>
</div>
<!--PreLoader Ends-->

<!-- header -->
<div class="top-header-area" id="sticker">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-sm-12 text-center">
                <div class="main-menu-wrap">
                    <!-- logo -->
                    <div class="site-logo">
                        <a href="/user">
                            <img src="/images/logo copy.png" alt="" width="50px">
                            <span class="text-white text-bold">AQUApets.in</span>
                        </a>
                    </div>
                    <!-- logo -->

                    <!-- menu start -->
                    <nav class="main-menu">
                        <ul>
                          <li class="current-list-item">
                            <a href="/user/home">Home</a>
                          </li>
                          <!-- <li><a href="about.html">About</a></li> -->
                          <li>
                            <a href="#">Categories</a>
                            <ul class="sub-menu">
            
                              <% if(allCategory.length > 0){ %> <% allCategory.forEach((category,
                                index) => { %>
                                <li><a href="/user/<%= category.name %>"><%= category.name %></a></li>
                                <% }); %> <% }else{ %>
                                <li><a href="#">No pages</a></li>
                              <% } %>
                              
                            </ul>
                          </li>
                          <!--
                          <li>
                            <a href="news.html">News</a>
                            <ul class="sub-menu">
                              <li><a href="news.html">News</a></li>
                              <li><a href="single-news.html">Single News</a></li>
                            </ul>
                          </li>
                          <li><a href="contact.html">Contact</a></li>
                        -->
                          <li>
                            <a href="/user/home">Shop</a>
                            <ul class="sub-menu">
                              <li><a href="/user/home">Shop</a></li>
                              <li><a href="/user/order">Orders</a></li>
                              <li><a href="/user/cart">Cart</a></li>
                              <li><a href="/user/wishList">Wish List</a></li>
                              <li><a href="/user/wallet">Wallet</a></li>
                            </ul>
                          </li>
                          <li>
                            <div class="header-icons">
                              <a class="mobile-hide" href="/user/myAccount"
                                ><i class="fa fa-user"></i>
                              </a>
                              <a class="shopping-cart" href="/user/cart"
                                ><i class="fas fa-shopping-cart"></i>
                              </a>
    
                              <a class="mobile-hide" href="/user/logout"
                                >Logout</a>
                              
                            </div>
                          </li>
                        </ul>
                      </nav>
                    <a class="mobile-show search-bar-icon" href="#"><i class="fas fa-search"></i></a>
                    <div class="mobile-menu"></div>
                    <!-- menu end -->
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end header -->

<!-- search area -->
<div class="search-area">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <span class="close-btn"><i class="fas fa-window-close"></i></span>
                <div class="search-bar">
                    <div class="search-bar-tablecell">
                        <h3>Search For:</h3>
                        <input type="text" placeholder="Keywords">
                        <button type="submit">Search <i class="fas fa-search"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end search arewa -->

<!-- breadcrumb-section -->
<div class="breadcrumb-section breadcrumb-bg">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 offset-lg-2 text-center">
                <div class="breadcrumb-text">
                    <p>update your account settings</p>
                    <h1>My Profile</h1>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end breadcrumb section -->

<!-- contact form -->
<div class="contact-from-section mt-100 mb-100">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 mb-5 mb-lg-0">
                <div class="form-title">
                    <h2>Personal Information</h2> 
                </div>
                <div>
                    <% 
                        if(typeof message2 !== 'undefined'){
                            %>
                            <h6 class="text-start" style="color: rgb(15, 185, 15);"><%= message2 %></h6>
                            <%
                        }
                    %>
                    <% 
                        if(typeof message1 !== 'undefined'){
                            %>
                            <h6 class="text-start" style="color: rgb(255, 0, 0);"><%= message1 %></h6>
                            <%
                        }
                    %>
                </div>

            <div id="form_status"></div>
                <div class="contact-form">
                    <form class="mb-2" action="/user/editEmail" method="post" type="POST" enctype="application/x-www-form-urlencoded">
                        <p>	
                            <label style="width: 16%;" for="email">Email Address</label>
                            <input type="hidden" name="id" value="<%= user._id %>">
                            <input style="width: 50%; margin-right: 5px;" type="email" name="email" id="email" value="<%= user.email %>" required>
                            <input type="submit" value="Edit & Submit">
                        </p>

                    </form>
                    <form class="mb-2" action="/user/editMobile" method="post" type="POST" enctype="application/x-www-form-urlencoded">
                        <p>
                            <label style="width: 16%;" for="email">Mobile Number</label>
                            <input type="hidden" name="id" value="<%= user._id %>">
                            <input style="width: 50%; margin-right: 5px;" type="text" name="mobile" id="mobile" value="<%= user.mobile %>" required>
                            <input type="submit" value="Edit & Submit">
                        </p>

                    </form>

                    <div>
                        
                            <% if (user && user.address && user.address.length > 0) { %>
                                <h6>Addresses:</h6>
                                <ul>
                                    <% user.address.forEach(addres => { %>
                                    
                                        <li style=" border-bottom: 1px solid #ccc; margin-top: 1px; margin-bottom: 1px;" class="mt-2 mb-2">
                                            <div class="row">
                                                <div style="width: 65%;">
                                                    <strong>House Name:</strong> <%= addres.house_name %><br>
                                                    <strong>Street:</strong> <%= addres.street %><br>
                                                    <strong>City:</strong> <%= addres.city %><br>
                                                    <strong>State:</strong> <%= addres.state %><br>
                                                    <strong>Postal Code:</strong> <%= addres.postalCode %><br>
                                                    <strong>Country:</strong> <%= addres.country %><br>
                                                </div>
                                                <div >
                                                    <button style="border: none;background: none;"><a class="mb-2 custom-button-2" href="/user/editAddress?user_id=<%= user._id %>&address=<%= addres._id %>" class="text-white" >Edit</a></button><br>
                                                    <button style="border: none;background: none;"><a class="mb-2 custom-button-2" href="/user/deleteAddress?user_id=<%= user._id %>&address=<%= addres._id %>" class="text-white" >Delete</a></button>
                                                </div>
                                            </div>
                                        </li>
                            
                                    <% }); %>
                                </ul>
                            <% } else { %>
                                <p>No addresses found.</p>
                            <% } %>
                        
                       
                        
                    </div>

                    <button style="width: 180px; background-color: rgb(159, 84, 84);" class="mb-2 custom-button" onclick="toggleForm(); return false;"><a href="#" class="text-white" >+ Add new Address</a></button>
                    <form  class="mb-2 p-3 hidden" style="background-color: rgb(255, 237, 237);" action="/user/addAddress" method="post" type="POST" id="addressForm" enctype="application/x-www-form-urlencoded" onSubmit="return valid_datas( this );">
                        
                        <p>
                            <label style="width: 120px;" for="house_name">House_name</label> 
                            <input type="text" name="house_name" id="house_name" required>     
                            
                        </p>
                        <p>                
                            <label style="width: 120px;" for="street">Street</label>  
                            <input type="text" name="street" id="street" required>    
                            
                        </p>
                        <p>
                            <label style="width: 120px;" for="city">City</label>      
                            <input type="text" name="city" id="city" required>
                        
                        </p>
                        <p>
                            <label style="width: 120px;" for="state">State</label>      
                            <input type="text" name="state" id="state" required>
                           
                        </p>
                        <p>
                            <label style="width: 120px;" for="postalCode">PostalCode</label>      
                            <input type="text" name="postalCode" id="postalCode" required>

                        </p>
                        <p>
                            <label style="width: 120px;" for="country">Country</label>      
                            <input type="text" name="country" id="country" required>
            
                        </p>
                        <p>
                            <input class="custom-button-3" type="submit" value="Add address">
                        </p>

                    </form>
                    <br>

                    <button style="width: 180px; background-color: rgb(159, 84, 84);" class="mb-2 custom-button" onclick="toggleFormPassword(); return false;"><a href="#" class="text-white" >Change Password</a></button>
                    <form class="mb-2 p-3 hidden" style="background-color: rgb(255, 237, 237)" action="/user/changePassword" method="post" type="POST" id="changePassword" enctype="application/x-www-form-urlencoded" onSubmit="return valid_datas( this );">
                        
                        <p>
                            <input type="hidden" name="email" id="email" value="<%= user.email %>" required> 
                            <label style="width: 120px;" for="currentPassword">Current Password</label> 
                            <input type="password" name="currentPassword" id="currentPassword" required>     
                            
                        </p>
                        <p>                
                            <label style="width: 120px;" for="newPassword">New Password</label>  
                            <input type="password" name="newPassword" id="newPassword" required>    
                            
                        </p>
                        <p>
                            <label style="width: 120px;" for="retypeNewPassword">Re-type New Password</label>      
                            <input type="text" name="retypeNewPassword" id="retypeNewPassword" required>
                        
                        </p>
                        <p>
                            <input type="submit" value="Save">
                        </p>

                    </form>

                </div>
            </div>
            <div class="col-lg-4">
                <div class="contact-form-wrap">
                    <div class="contact-form-box">
                        <h4><i class="fas fa-map"></i> Shop Address</h4>
                        <p>34/8, East Hukupara <br> Gifirtok, Sadan. <br> Country Name</p>
                    </div>
                    <div class="contact-form-box">
                        <h4><i class="far fa-clock"></i> Shop Hours</h4>
                        <p>MON - FRIDAY: 8 to 9 PM <br> SAT - SUN: 10 to 8 PM </p>
                    </div>
                    <div class="contact-form-box">
                        <h4><i class="fas fa-address-book"></i> Contact</h4>
                        <p>Phone: +00 111 222 3333 <br> Email: tijindayi@gmail.com.com</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end contact form -->



<!-- footer -->
<div class="footer-area">
    <div class="container">
        <div class="row">
            <div class="col-lg-3 col-md-6">
                <div class="footer-box about-widget">
                    <h2 class="widget-title">About us</h2>
                    <p>Ut enim ad minim veniam perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae.</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="footer-box get-in-touch">
                    <h2 class="widget-title">Get in Touch</h2>
                    <ul>
                        <li>34/8, East Hukupara, Gifirtok, Sadan.</li>
                        <li>support@fruitkha.com</li>
                        <li>+00 111 222 3333</li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="footer-box pages">
                    <h2 class="widget-title">Pages</h2>
                    <ul>
                        <li><a href="/user">Home</a></li>
                        <li><a href="/user">About</a></li>
                        <li><a href="/user">Shop</a></li>
                        <li><a href="/user">News</a></li>
                        <li><a href="/user">Contact</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="footer-box subscribe">
                    <h2 class="widget-title">Subscribe</h2>
                    <p>Subscribe to our mailing list to get the latest updates.</p>
                    <form action="/user">
                        <input type="email" placeholder="Email">
                        <button type="submit"><i class="fas fa-paper-plane"></i></button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end footer -->

<!-- copyright -->
<div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 col-md-12">
                <p>Copyrights &copy; 2019 - <a href="/user">AQUApets.in</a>,  All Rights Reserved.<br>
                    
                </p>
            </div>
            <div class="col-lg-6 text-right col-md-12">
                <div class="social-icons">
                    <ul>
                        <li><a href="#" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
                        <li><a href="#" target="_blank"><i class="fab fa-twitter"></i></a></li>
                        <li><a href="#" target="_blank"><i class="fab fa-instagram"></i></a></li>
                        <li><a href="#" target="_blank"><i class="fab fa-linkedin"></i></a></li>
                        <li><a href="#" target="_blank"><i class="fab fa-dribbble"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
    function toggleForm() {
        var form = document.getElementById("addressForm");
        form.classList.toggle("hidden");
    }

    function toggleFormPassword() {
        var form = document.getElementById("changePassword");
        form.classList.toggle("hidden");
    }

    //validating add address
document.getElementById('addressForm').addEventListener('submit', function (event) {
        event.preventDefault();

        if (validateForm()) {
            this.submit();
        }
    });

    function validateForm() {
        const houseName = document.getElementById('house_name').value;
        const street = document.getElementById('street').value;
        const city = document.getElementById('city').value;
        const state = document.getElementById('state').value;
        const postalCode = document.getElementById('postalCode').value;
        const country = document.getElementById('country').value;

        if (houseName.trim() === '') {
            showErrorAlert('Please enter a house name.');
            return false;
        }

        if (street.trim() === '') {
            showErrorAlert('Please enter a street name.');
            return false;
        }

        if (city.trim() === '') {
            showErrorAlert('Please enter a city name.');
            return false;
        }

        if (state.trim() === '') {
            showErrorAlert('Please enter a state name.');
            return false;
        }

        if (postalCode.trim() === '') {
            showErrorAlert('Please enter a postal code.');
            return false;
        }

        if (country.trim() === '') {
            showErrorAlert('Please enter a country name.');
            return false;
        }

        return true;
    }

    function showErrorAlert(message) {
        Swal.fire({
            icon: 'error',
            title: 'Validation Error',
            text: message,
        });
    }
</script>

<%- include('../layouts/footer.ejs')  %> 
